---
title: "MPG Transmission"
author: "Joohyun Kwon"
date: "April 5, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#load mtcars data
data(mtcars)
str(mtcars)
head(mtcars)
tail(mtcars)

```


```{r}
mtcars$am = as.factor(mtcars$am)
mtcars$cyl = as.factor(mtcars$cyl)
mtcars$vs = as.factor(mtcars$vs)
mtcars$gear = as.factor(mtcars$gear)
mtcars$carb = as.factor(mtcars$carb)
str(mtcars)
boxplot(mpg ~ am, data=mtcars, main="Mileage by Transmission Type", ylab="MPG (Mile per Gallon)",
        col=c("lightgreen","lightblue"), names=c("automaitc", "manual"))
```

from the boxplot, we can see cars with manual transmission have on average much higher mpg. Also, more than 75% of cars with manual transmission have higher mpg than 75% of cars with automaitc transmission. It is quite apparent. However, we will investigate how other factors such as displacement, number of cylinder and etc are influencing this.

```{r}
with(mtcars, tapply(mpg, am, summary))
fit = lm(mpg ~ am, data=mtcars)
summary(fit)
```

```{r}
pairs(mtcars, panel = panel.smooth, col = 3 + (mtcars$am == 1))
```

```{r}
par(mfrow=c(1,3))
with(mtcars, plot(disp, mpg, col=am))
with(mtcars, plot(hp, mpg, col=am))
with(mtcars, plot(wt, mpg, col=am))
```
Let's have a look at the coefficient of type of transmission when all the variables are taken as regressor.
```{r}
fitAll <- lm(mpg ~ ., data=mtcars)
summary(fitAll)
library(car)
vif(fitAll)
```

```{r}
fit_cyl_carb = lm(mpg ~ . - cyl - carb, data=mtcars)
anova(fitAll,fit_cyl_carb)
fit_l = lm(mpg ~ am + disp + hp +drat + wt + qsec +vs +gear, data=mtcars)
vif(fit_l)
fit_l_g = lm(mpg ~ am + disp + hp +drat + wt + qsec +vs, data=mtcars)
anova(fit_l, fit_l_g)
```