---
title: "MPG Transmission"
author: "Joohyun Kwon"
date: "April 5, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
#Executive Summary
We are interested in analyzing various factors that influence gas mileage (MPG - Mile Per Gallon) of a car. Particulary we will look at the influence of transmission type on gas mileage. We collected various data from 33 cars and analyzed them in order to answer below questions:

- Is an automatic or manual transmission better for MPG
- What is MPG difference between those two transmission types


```{r}
#load mtcars data
data(mtcars)
str(mtcars)
head(mtcars)
tail(mtcars)

cor(mtcars)
```


```{r}
mtcars$am = as.factor(mtcars$am)
mtcars$cyl = as.factor(mtcars$cyl)
mtcars$vs = as.factor(mtcars$vs)
mtcars$gear = as.factor(mtcars$gear)
mtcars$carb = as.factor(mtcars$carb)
str(mtcars)
boxplot(mpg ~ am, data=mtcars, main="Mileage by Transmission Type", ylab="MPG (Mile per Gallon)",
        col=c("lightgreen","lightblue"), names=c("automaitc", "manual"))
```

from the boxplot, we can see cars with manual transmission have on average much higher mpg. Also, more than 75% of cars with manual transmission have higher mpg than 75% of cars with automaitc transmission. It is quite apparent. However, we will investigate how other factors such as displacement, number of cylinder and etc are influencing this.

```{r}
with(mtcars, tapply(mpg, am, summary))
fit = lm(mpg ~ am, data=mtcars)
summary(fit)
```

```{r}
#create a vector with mtcars's column names - "am"
x <- names(mtcars)
x <- x[! x == "am" & ! x == "mpg" ]
#tt <- data.frame()
#names(tt) <- c("formula", "coefficient", "P-Value")
for (i in 1:length(x)) {
    fml <- NULL; y <-NULL ; fit_temp <- NULL
    fml <- paste("mpg ~ am + ", x[i] )
    fit_temp <- lm(fml, data=mtcars) 
    y <- c(fml,round(summary(fit_temp)$coefficients[2,1],2),
           round(summary(fit_temp)$coefficients[2,4],2))
    y <- as.character(y); print(y)
   # tt <- rbind(tt,y)
}

```
hp, qsec, vs, carb
```{r}
fit1 = lm(mpg ~ am + hp, data=mtcars)
summary(fit1)
```

```{r}
fit2 = lm(mpg ~ am + hp + qsec, data=mtcars)
summary(fit2)
anova(fit1,fit2)
```

```{r}

fit3 = lm(mpg ~ am + hp + vs, data=mtcars)
summary(fit3)
anova(fit1,fit3)
```

```{r}

fit4 = lm(mpg ~ am + hp + carb, data=mtcars)
summary(fit4)
anova(fit1,fit4)
```

```{r}
fit5 = lm(mpg ~ am + hp + disp, data=mtcars)
summary(fit5)
anova(fit1,fit5)
```

```{r}

fit6 = lm(mpg ~ am + hp + qsec+ vs + carb, data=mtcars)
summary(fit6)
anova(fit1,fit6)
```

```{r}
pairs(mtcars, panel = panel.smooth, col = 3 + (mtcars$am == 1))
```

```{r}
par(mfrow=c(1,3))
with(mtcars, plot(disp, mpg, col=am))
with(mtcars, plot(hp, mpg, col=am))
with(mtcars, plot(wt, mpg, col=am))
```
Let's have a look at the coefficient of type of transmission when all the variables are taken as regressor.
```{r}
fitAll <- lm(mpg ~ ., data=mtcars)
summary(fitAll)
library(car)
vif(fitAll)
```



```{r}
fit_cyl_carb = lm(mpg ~ . - cyl - carb, data=mtcars)
anova(fitAll,fit_cyl_carb)
fit_l = lm(mpg ~ am + disp + hp +drat + wt + qsec +vs +gear, data=mtcars)
vif(fit_l)
fit_l_g = lm(mpg ~ am + disp + hp +drat + wt + qsec +vs, data=mtcars)
anova(fit_l, fit_l_g)
```